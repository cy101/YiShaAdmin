(function(n){"use strict";n.fn.ysRadioBox=function(t,i){var u,f,r,e;return typeof t=="string"?n.fn.ysRadioBox.methods[t](this,i):(u=n(this),f=u.attr("id"),!f)?!1:(r=n.extend({url:null,key:"Key",value:"Value",data:null,dataName:"Result","default":undefined},t),e={loadData:function(){r.url&&n.ajax({url:r.url,type:"get",dataType:"json","async":!1,cache:!1,success:function(n){r.data=n;r.dataName&&r.data!=null&&(r.data=r.data[r.dataName])},error:function(){throw exception;}})},render:function(t){if(t.data&&t.data.length>=0){var r=u.attr("ref"),e=f+"_radiobox",i="";n.each(t.data,function(n){var u=t.data[n];i+="<label class='radio-box'>";i+="<input type='radio' name='"+e+"' value='"+u[t.key]+"' ref='"+r+"' /> "+u[t.value];i+="<\/label>";u.IsDefault==1&&(t.default=u[t.key])});u.append(i)}t.default!=undefined&&u.ysRadioBox("setValue",t.default)}},e.loadData(),e.render(r),u)};n.fn.ysRadioBox.methods={getValue:function(t){var i="";return n(t).find("div.checked").each(function(t,r){i+=n(r).find("input[type=radio]").val();i+=","}),i.indexOf(",")>=0&&(i=i.substring(0,i.length-1)),i},setValue:function(t,i){if(!ys.isNullOrEmpty(i)){typeof i!="string"&&(i=i.toString());n(t).find("div").each(function(t,i){n(i).removeClass("checked")});var r=i.split(",");n.each(r,function(i,r){var u=n(t).find("input[type=radio][value="+r+"]");u.attr("checked",!0);u.parent().addClass("checked")})}}};n.fn.ysCheckBox=function(t,i){var u,f,r,e;return typeof t=="string"?n.fn.ysCheckBox.methods[t](this,i):(u=n(this),f=u.attr("id"),!f)?!1:(r=n.extend({url:null,key:"Key",value:"Value",data:null,dataName:!1,"default":undefined},t),e={loadData:function(){r.url&&(n.ajax({url:r.url,type:"get",dataType:"json","async":!1,cache:!1,success:function(n){r.data=n},error:function(){throw exception;}}),r.dataName&&r.data!=null&&(r.data=r.data[r.dataName]))},render:function(t){if(t.data&&t.data.length>=0){var r=f+"_checkbox",i="";n.each(t.data,function(n){var u=t.data[n];i+="<label class='check-box'>";i+="<input name='"+r+"' type='checkbox' value='"+u[t.key]+"'>"+u[t.value]+"<\/input>";i+="<\/label>";u.IsDefault==1&&(t.default=u[t.key])});u.append(i)}t.default!=undefined&&u.ysCheckBox("setValue",t.default)}},e.loadData(),e.render(r),u)};n.fn.ysCheckBox.methods={getValue:function(t){var i="";return n(t).find("div.checked").each(function(t,r){i+=n(r).find("input[type=checkbox]").val();i+=","}),i.indexOf(",")>=0&&(i=i.substring(0,i.length-1)),i},setValue:function(t,i){if(!ys.isNullOrEmpty(i)){typeof i!="string"&&(i=i.toString());var r=i.split(",");n.each(r,function(i,r){var u=n(t).find("input[type=checkbox][value="+r+"]");u.attr("checked",!0);u.parent().addClass("checked")})}}};n.fn.ysComboBox=function(t,i){var u,f,r,e;return typeof t=="string"?n.fn.ysComboBox.methods[t](this,i):(u=n(this),f=u.attr("id"),!f)?!1:(r=n.extend({url:null,key:"Key",value:"Value",maxHeight:"160px","class":null,multiple:!1,data:null,dataName:"Result",onChange:null,"default":undefined},t),e={loadData:function(){r.url&&(n.ajax({url:r.url,type:"get",dataType:"json","async":!1,cache:!1,success:function(n){r.data=n},error:function(){throw exception;}}),r.dataName&&r.data!=null&&(r.data=r.data[r.dataName]))},render:function(t){var r,o,e,s,i,h;t.data&&t.data.length>=0&&(r=f+"_select",o="",t.multiple&&(o='multiple=""'),e="<select id='"+r+"' name='"+r+"' class='"+ys.toString(t.class)+" select2' "+o+" maxheight="+t.maxHeight+">",s=n("#"+r).length>0,s&&n("#"+r).empty(),i="",h=!1,t.data.length>0&&(h=t.data[0][t.value]instanceof Array),h||(t.class?t.multiple||(i+="<option value='' selected='selected'>请选择<\/option>"):i+="<option value='-1'>全部<\/option>"),n.each(t.data,function(r){var u=t.data[r];typeof u=="string"?i+="<option value='"+u+"'>"+u+"<\/option>":u[t.value]instanceof Array?(i+="<optgroup label='--"+u[t.key]+"--'>",n.each(u[t.value],function(n){var r=u[t.value][n];i+="<option value='"+r[t.key]+"'>"+r[t.value]+"<\/option>";u.IsDefault==1&&(t.default=u[t.key])})):(i+="<option value='"+u[t.key]+"'>"+u[t.value]+"<\/option>",u.IsDefault==1&&(t.default=u[t.key]))}),s?n("#"+r).append(i):(e+=i,e+="<\/select>",u.append(e),t.onChange&&n("#"+r).change(t.onChange)),n("#"+r).select2(),n("#"+f).find(".select2-container").width(280),t.default!=undefined&&u.ysComboBox("setValue",t.default))}},e.loadData(),e.render(r),u)};n.fn.ysComboBox.methods={getValue:function(t){var i=n("#"+n(t).attr("id")+"_select").select2("val");return i==null?"":i.toString()},setValue:function(t,i){ys.isNullOrEmpty(i)||(typeof i!="string"&&(i=i.toString()),n("#"+n(t).attr("id")+"_select").val(i.split(",")).trigger("change"))}};n.fn.getWebControls=function(t){var i={};return t&&typeof t=="object"&&(i=t),n(this).find("[col]").each(function(t,r){var f=n(r).attr("id"),u=n(r).attr("col");r.tagName=="INPUT"?r.type=="checkbox"?n(r).prop("checked")&&(i[u]=i[u]?i[u]+","+n(r).val():n(r).val()):r.type=="radio"?n(r).prop("checked")&&(i[u]=n(r).val()):i[u]=n(r).val():r.tagName=="SELECT"?i[u]=n(r).val():r.tagName=="DIV"?i[u]=n(r).find("#"+f+"_tree").length>0?n(r).ysComboBoxTree("getValue"):n(r).find("#"+f+"_select").length>0?n(r).ysComboBox("getValue"):n(r).find("input[type=checkbox]").length>0?n(r).ysCheckBox("getValue"):n(r).find("input[type=radio]").length>0?n(r).ysRadioBox("getValue"):n(r).html():r.tagName=="IMG"?i[u]=n(r).prop("src"):r.tagName=="SPAN"?i[u]=n(r).find("#"+f+"_select").length>0?n(r).ysComboBox("getValue"):n(r).html():r.tagName=="TEXTAREA"&&(i[u]=n(r).val())}),i};n.fn.setWebControls=function(t){return n(this).find("[col]").each(function(i,r){var f=n(r).attr("id"),u=n(r).attr("col");r.tagName=="INPUT"?r.type=="checkbox"?n(r).prop("checked")&&(t[u]?t[u]=t[u]+","+n(r).val():n(r).val(t[u])):r.type=="radio"?n(r).val()==t[u]&&(n(r).iCheck?n(r).iCheck("check"):n(r).prop("checked",!0)):n(r).val(t[u]):r.tagName=="SELECT"?n(r).val(t[u]):r.tagName=="DIV"?n(r).find("#"+f+"_tree").length>0?n(r).ysComboBoxTree("setValue",t[u]):n(r).find("#"+f+"_select").length>0?n(r).ysComboBox("setValue",t[u]):n(r).find("input[type=checkbox]").length>0?n(r).ysCheckBox("setValue",t[u]):n(r).find("input[type=radio]").length>0?n(r).ysRadioBox("setValue",t[u]):n(r).html(t[u]):r.tagName=="SPAN"?n(r).html(t[u]):r.tagName=="TEXTAREA"&&n(r).val(t[u])}),t}})(window.jQuery);